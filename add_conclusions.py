# -*- coding: utf-8 -*-
import sys
import io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

from docx import Document
from docx.shared import Pt, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document(r'C:\Users\Iurii\Downloads\ХОМЕНКО_521_МАГІСТЕРСЬКА_UPDATED4.docx')

# Висновки до розділів
conclusion_1 = """Висновки до розділу 1

У першому розділі магістерської роботи було досліджено теоретичні засади створення багатоплатформенних систем електронної комерції. Проведений аналіз дозволив сформулювати наступні висновки:

1. Дослідження аудиторії є фундаментальним етапом розробки систем електронної комерції. Встановлено, що комплексне застосування методів опитування, інтерв'ювання, аналізу поведінкових даних та A/B-тестування дозволяє сформувати точний портрет цільового користувача та адаптувати функціонал системи під його потреби.

2. Обґрунтовано застосування базових законів UI/UX-дизайну (закони Якоба, Фітта, Хікса та Міллера) для створення інтуїтивно зрозумілого інтерфейсу онлайн-магазину. Дотримання цих принципів забезпечує зниження когнітивного навантаження користувачів та підвищення конверсії.

3. Статистичний аналіз ринку електронної комерції підтвердив необхідність багатоплатформенного підходу до розробки: близько 63% глобального веб-трафіку надходить з мобільних пристроїв, а 57% онлайн-продажів здійснюються через смартфони. Це обумовлює обов'язкову підтримку веб-версії, мобільних застосунків для Android та iOS, а також десктопних клієнтів.

4. Визначено критичну роль безпеки користувачів та персональних даних у системах електронної комерції. Впровадження протоколу OpenID Connect, JWT-автентифікації та захищених платіжних шлюзів є обов'язковими вимогами до сучасних онлайн-магазинів.

5. Обґрунтовано доцільність застосування гібридної методології розробки Agile/Scrum у поєднанні з DevOps-практиками. Такий підхід забезпечує гнучкість реагування на зміни вимог, швидкий випуск MVP та автоматизацію процесів CI/CD.

6. Порівняльний аналіз провідних платформ електронної комерції (Amazon, Zalando, ASOS, IKEA, Rozetka) дозволив виявити ключові архітектурні патерни та технологічні рішення, що забезпечують масштабованість та надійність систем.

7. Сформовано технологічний стек для реалізації системи FullMag: NestJS для серверної частини, Next.js для веб-застосунку, React Native для мобільного клієнта, PostgreSQL як основна СУБД, Redis для кешування, Elasticsearch для повнотекстового пошуку. Обраний стек забезпечує оптимальне співвідношення продуктивності, масштабованості та швидкості розробки.

"""

conclusion_2 = """Висновки до розділу 2

У другому розділі магістерської роботи було виконано комплексне проєктування програмної системи електронної комерції. На основі проведеної роботи можна зробити наступні висновки:

1. Сформульовано детальні функціональні вимоги до системи, що охоплюють понад 150 конкретних функцій: автентифікація та авторизація з підтримкою трьох ролей (admin, manager, customer), управління товарами з динамічними атрибутами, ієрархічна структура категорій, фасетний пошук та фільтрація, кошик з синхронізацією для авторизованих користувачів, багатокроковий процес оформлення замовлень, інтеграція з платіжними системами та службами доставки.

2. Визначено нефункціональні вимоги до системи щодо продуктивності (час відгуку API до 500ms, підтримка до 10000 товарів та 1000 одночасних користувачів), масштабованості, безпеки (HTTPS, bcrypt-хешування паролів, захист від OWASP Top 10), доступності (99.5% uptime) та зручності використання.

3. Для ефективного управління процесом розробки обрано платформу ClickUp з налаштуванням ієрархічної структури проєкту (простори, папки, списки). Визначено життєвий цикл завдань з шістьма статусами та інтегровано інструменти для візуалізації прогресу через Scrum-дошки.

4. Обґрунтовано вибір Git як системи контролю версій із застосуванням GitHub Flow стратегії розгалуження. Впроваджено стандарт Conventional Commits для забезпечення читабельності історії змін та автоматизації генерації CHANGELOG.

5. Для проєктування користувацького інтерфейсу використано хмарний інструмент Figma з створенням комплексної дизайн-системи, що включає колірну палітру, типографіку, бібліотеку компонентів та інтерактивні прототипи. Застосовано Dev Mode для ефективної передачі дизайну в розробку.

6. Спроєктовано архітектуру фронтенд-додатку з використанням компонентного підходу React та App Router Next.js. Визначено структуру компонентів (layout, catalog, product, cart, checkout), систему управління станом на базі Zustand та дизайн-систему з адаптивним дизайном за принципом Mobile-First.

7. Розроблено структуру бази даних PostgreSQL з 10+ основними таблицями: users, categories, characteristics, products, product_characteristics, reviews, orders, order_items, chats, messages. Визначено зв'язки між сутностями та індекси для оптимізації запитів.

8. Створено концептуальну схему бази даних та визначено типи даних для всіх атрибутів сутностей, що забезпечує цілісність даних та ефективність виконання запитів.

"""

conclusion_3 = """Висновки до розділу 3

У третьому розділі магістерської роботи описано реалізацію програмної системи електронної комерції FullMag. Проведена робота дозволяє сформулювати наступні висновки:

1. Застосовано уніфіковану мову моделювання UML 2.5.1 для візуалізації архітектури системи. Розроблено комплект діаграм: діаграму прецедентів з трьома акторами (відвідувач, клієнт, адміністратор), діаграму класів з основними сутностями та їх зв'язками, діаграму пакетів з трирівневою архітектурою (презентаційний шар, бізнес-логіка, доступ до даних).

2. Діаграма прецедентів визначила функціональні можливості системи для кожної ролі користувача: незареєстрований відвідувач має доступ до перегляду каталогу та пошуку, зареєстрований клієнт - до оформлення замовлень, відгуків та списку бажань, адміністратор - до управління всіма аспектами системи та аналітики.

3. Діаграма класів відображає структурну модель з центральними класами User, Product, Category, Order, Cart, Review та їх взаємозв'язками (композиція, агрегація, асоціація). Встановлено кардинальність зв'язків для забезпечення цілісності даних.

4. Реалізовано повнофункціональний веб-застосунок з адаптивним дизайном, що включає: головну сторінку з банерами та рекомендаціями, каталог товарів з фільтрацією та сортуванням, детальні сторінки товарів з галереєю зображень та відгуками, кошик та багатокроковий checkout, особистий кабінет користувача, адміністративну панель з аналітикою.

5. Розроблено мобільний застосунок на React Native з підтримкою платформ Android та iOS. Застосунок реалізує всі основні функції покупця з адаптованим для мобільних пристроїв інтерфейсом: нижня навігаційна панель, модальні вікна для фільтрації та сортування, оптимізовані картки товарів.

6. Впроваджено систему email-сповіщень з шаблонами Handlebars для нагадування про покинуті кошики, підтвердження замовлень та оновлення статусів доставки. Інтегровано Telegram та WhatsApp боти для багатоканальної комунікації з клієнтами.

7. Визначено мінімальні вимоги до апаратного та програмного забезпечення: для веб-клієнта - браузери Chrome 90+, Firefox 90+, Safari 14+, Edge 90+; для мобільного застосунку - Android 7.0+ або iOS 13.0+.

8. Спроєктовано напрямки подальшого вдосконалення системи: інтеграція Elasticsearch для покращення пошуку з нечітким співпадінням та автодоповненням, впровадження CQRS-архітектури для аналітики, міграція на хмарну інфраструктуру AWS з використанням EKS/ECS, налаштування захисту від DDoS через AWS Shield та WAF, оптимізація доставки контенту через CloudFront CDN.

"""

conclusions = {
    "ROZD1": conclusion_1,
    "ROZD2": conclusion_2,
    "ROZD3": conclusion_3
}

# Знаходимо параграфи та додаємо висновки
paragraphs = doc.paragraphs
insertions = []

for i, para in enumerate(paragraphs):
    text = para.text.strip()
    if "РОЗДІЛ 2" in text and "ПРОЕКТУВАННЯ" in text.upper():
        insertions.append(("ROZD1", i))
    elif "РОЗДІЛ 3" in text and "ОПИС РЕАЛІЗАЦІЇ" in text.upper():
        insertions.append(("ROZD2", i))
    elif text == "ВИСНОВКИ":
        insertions.append(("ROZD3", i))

print(f"Found {len(insertions)} insertion points")

# Додаємо висновки (в зворотному порядку, щоб індекси не зміщувалися)
for section, index in reversed(insertions):
    conclusion_text = conclusions[section]
    # Вставляємо новий параграф перед наступним розділом
    new_para = paragraphs[index].insert_paragraph_before(conclusion_text)
    new_para.style = doc.styles['Normal']
    print(f"Added conclusion for {section} at index {index}")

# Зберігаємо документ
output_path = r'C:\Users\Iurii\Downloads\ХОМЕНКО_521_МАГІСТЕРСЬКА_UPDATED5.docx'
doc.save(output_path)
print(f"Document saved successfully!")
