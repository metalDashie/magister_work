# -*- coding: utf-8 -*-
import sys
sys.stdout.reconfigure(encoding='utf-8')

from docx import Document
from docx.shared import Pt, Cm
from docx.enum.text import WD_ALIGN_PARAGRAPH

# Створюємо новий документ на основі зразка
doc = Document(r'C:\magister_work\docs\response\Відгук_Зразок (1).docx')

# Текст для заміни
replacements = {
    'Луцик О.Р.': 'Хоменко Ю.Ю.',
    'Луцика О.Р.': 'Хоменка Ю.Ю.',
    'Луцик Олександр Романович': 'Хоменко Юрій Юрійович',
    'Луцика Олександра Романовича': 'Хоменка Юрія Юрійовича',
    '«Методологічні засади розробки мультимедійних тезаурусів»': '«Методика та застосунок багатоплатформенної системи онлайн-магазину»',
    'Методологічні засади розробки мультимедійних тезаурусів': 'Методика та застосунок багатоплатформенної системи онлайн-магазину',
    '2023': '2025',
}

# Новий текст для параграфів (індекси відповідають порядку в документі)
new_paragraphs = {
    # Тема
    8: 'Тема кваліфікаційної роботи Хоменка Ю.Ю. «Методика та застосунок багатоплатформенної системи онлайн-магазину» обрана з урахуванням існуючих проблем, що виникають у процесі розробки сучасних систем електронної комерції та забезпечення їх доступності на різних платформах.',

    # Мета
    9: 'Мета кваліфікаційної роботи – розробка багатоплатформенного програмного засобу для онлайн-магазину, дослідження методик і варіантів розробки програмного забезпечення, вибір оптимальної архітектури та технологій для створення системи електронної комерції, яка відповідає сучасним вимогам ринку.',

    # Виконав
    10: 'Студент Хоменко Ю.Ю. кваліфікаційну роботу виконав у відповідності до завдання, затвердженого завідувачем кафедри.',

    # Показав уміння
    13: 'У ході виконання кваліфікаційної роботи студент Хоменко Ю.Ю. продемонстрував уміння працювати з науковою, технічною, довідковою та нормативною літературою, аналізувати теоретичний та практичний матеріал, приймати зважені та обґрунтовані технічні рішення, застосовувати сучасні технології розробки програмного забезпечення, зокрема TypeScript, NestJS, Next.js, React Native, PostgreSQL та інші.',

    # Опис роботи
    15: 'У ході виконання кваліфікаційної роботи було розглянено питання розробки багатоплатформенної системи електронної комерції. Досліджено сучасні підходи до створення онлайн-магазинів та методології розробки програмного забезпечення. Проаналізовано ринок електронної комерції та провідні платформи (Amazon, Zalando, ASOS, Rozetka). Обґрунтовано вибір технологічного стеку та архітектурних рішень. Розроблено систему FullMag, що включає веб-застосунок на Next.js, мобільний застосунок на React Native та серверну частину на NestJS з використанням PostgreSQL, Redis та Elasticsearch.',

    # Практична реалізація
    16: 'В роботі було наведено детальний опис архітектури та функціональних можливостей розробленої системи. Реалізовано повний цикл електронної комерції: каталог товарів з ієрархічними категоріями, система фільтрації та пошуку, кошик покупок, оформлення замовлень з інтеграцією Нової Пошти, онлайн-оплата через Stripe, система відгуків, список бажань, порівняння товарів, система знижок та купонів. Застосовано методологію Agile/Scrum з DevOps-практиками та контейнеризацією Docker.',

    # Висновок
    19: 'Рівень підготовки кваліфікаційної роботи «Методика та застосунок багатоплатформенної системи онлайн-магазину» та виявлений рівень знань, умінь та навичок свідчить про те, що Хоменко Юрій Юрійович заслуговує присвоєння освітньо-кваліфікаційного рівня «Магістр» за спеціальністю «Інженерія програмного забезпечення».',
}

# Замінюємо текст у параграфах
para_count = 0
for para in doc.paragraphs:
    if para.text.strip():
        para_count += 1

        # Якщо є повна заміна параграфа
        if para_count in new_paragraphs:
            # Зберігаємо форматування першого run
            if para.runs:
                font_name = para.runs[0].font.name
                font_size = para.runs[0].font.size
                bold = para.runs[0].bold

            para.clear()
            run = para.add_run(new_paragraphs[para_count])
            if font_name:
                run.font.name = font_name
            if font_size:
                run.font.size = font_size
        else:
            # Простa заміна тексту
            for old, new in replacements.items():
                if old in para.text:
                    for run in para.runs:
                        if old in run.text:
                            run.text = run.text.replace(old, new)

# Зберігаємо документ
output_path = r'C:\Users\Iurii\Downloads\ВІДГУК_ХОМЕНКО.docx'
doc.save(output_path)
print(f'Документ збережено: {output_path}')
